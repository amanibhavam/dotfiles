#!/usr/bin/env bash

# pod -n karpenter scale deployment --replicas=0 inflate

pass hello
app delete -y k3d-control-karpenter
pod delete ns karpenter
pod create ns karpenter
eval $(aws-vault exec gyre-ops-sso --json | jq -r '"pod create secret generic -n karpenter karpenter-aws --from-literal=AWS_ACCESS_KEY_ID=\(.AccessKeyId) --from-literal=AWS_SECRET_ACCESS_KEY=\(.SecretAccessKey) --from-literal=AWS_SESSION_TOKEN=\(.SessionToken)"')
app sync k3d-control-karpenter
pod apply -f provisioner.yaml